var alarmUrl=ECS.api.apUrl+"/fileAlarmChild/getTransferPoliceInfo";var mergeAlarmUrl=ECS.api.apUrl+"/fileAlarmChild/policeMerger";var status;$(function(){var a={init:function(){mini.parse();this.bindUI();a.logic.initPage()},table:{},bindUI:function(){$("input").blur(function(){$(this).val($.trim($(this).val()))});$(".btnClose").click(function(){a.logic.closeLayer()})},data:{param:{}},logic:{setData:function(c){a.data.param.eventId=c.eventId;var b=mini.get("datagrid");b.load({seatIp:"",eventId:c.eventId})},initPage:function(){var b=mini.get("datagrid");b.set({url:alarmUrl,ajaxType:"GET",dataField:"pageList"})},renderer_operate:function(c){var b=c.record.eventId;return'<a href="javascript:window.page.logic.mergeAlarm('+b+')" class="btn btn-primary" style="width:48px;height:18px;">合并</a>'},mergeAlarm:function(b){ECS.util.addOrEdit({url:mergeAlarmUrl+"?eventId="+b+"&eventIdm="+a.data.param.eventId,pageMode:PageModelEnum.Edit},function(c){c=$.parseJSON(c);if(c.isSuccess){status=true;layer.msg("操作成功");a.logic.closeLayer()}else{layer.msg("操作失败")}})},closeLayer:function(){if(status){window.parent.pageLoadMode=PageLoadMode.Refresh}var b=parent.layer.getFrameIndex(window.name);parent.layer.close(b)}}};a.init();window.page=a});