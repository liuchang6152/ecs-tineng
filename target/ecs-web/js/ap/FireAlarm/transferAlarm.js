var fireUnitUrl=ECS.api.apUrl+"/fileAlarmChild/getFileUnit";var transferAlarmUrl=ECS.api.apUrl+"/fileAlarmChild/transferPolice/";var status;$(function(){var a=parent.layer.getFrameIndex(window.name);var b={init:function(){mini.parse();b.logic.initPage();b.logic.search();this.bindUI()},bindUI:function(){$(".btnClose").click(function(){b.logic.closeLayer(false)});$("#btnSave").click(function(){b.logic.save()});$("#btnQuery").click(function(){b.logic.search()})},data:{param:{}},logic:{setData:function(c){b.data.param.eventId=c.eventId},initPage:function(){var c=mini.get("datagrid");c.set({url:fireUnitUrl,ajaxType:"get",dataField:"pageList"})},search:function(){var c=mini.get("datagrid");var d=new mini.Form("searchForm");var e=d.getData();c.load(e)},renderer_Operate:function(c){return"<a href=\"javascript:window.page.logic.transferAlarm('"+c.record.tel+'\')" class="btn btn-primary" style="width:48px;height:18px;">转接</a>'},transferAlarm:function(c){eventId=b.data.param.eventId;ECS.util.addOrEdit({url:transferAlarmUrl+eventId},function(d){d=$.parseJSON(d);if(d.isSuccess){status=true;parent.parent.transfer(c);b.logic.closeLayer()}else{layer.msg("操作失败")}})},closeLayer:function(c){if(status){window.parent.pageLoadMode=PageLoadMode.Refresh}parent.layer.close(a)}}};b.init();window.page=b});