var noFeedbackUrl=ECS.api.apUrl+"/firemanGo/noFeedback";var changeStateUrl=ECS.api.apUrl+"/firemanGo/changeState";var vm=new Vue({el:"#main",data:{items:[],eventId:""}});$(function(){var a=parent.layer.getFrameIndex(window.name);var b={init:function(){mini.parse();this.bindUI()},bindUI:function(){$("#btnSave").click(function(){b.logic.save()});$(".btnClose").click(function(){window.pageLoadMode=PageLoadMode.None;b.logic.closeLayer(false)})},logic:{setData:function(d,c){vm.eventId=c;b.logic.initData(d)},initData:function(g){if(g.result){var e=[];for(var d=0;d<g.result.length;d++){for(var c=0;c<g.result[d].list.length;c++){var f=g.result[d].list[c];e.push(f.contactWay)}}}vm.items=g.result},singleCall:function(c){parent.parent.callNs(c.contactWay)},save:function(d){var c={firemanGoID:d.firemanGoID};$.ajax({url:changeStateUrl,async:false,type:"put",data:JSON.stringify(c),dataType:"json",contentType:"application/json;charset=utf-8",beforeSend:function(){$("#"+d.firemanGoID).attr("disabled","disabled");ECS.showLoading()},success:function(e){ECS.hideLoading();if(e.isSuccess){layer.msg("确认成功！",{time:1000},function(){parent.page.logic.init();$("#"+d.firemanGoID).text("已反馈");$("#"+d.firemanGoID).prev(["data="+d.firemanGoID]).hide()})}else{layer.msg(e.message)}},error:function(e){$("#"+d.firemanGoID).attr("disabled",false);ECS.hideLoading();layer.msg("系统繁忙")}})},closeLayer:function(c){window.parent.pageLoadMode=window.pageLoadMode;parent.layer.close(a)}}};b.init();window.page=b});