var meetingRecordUrl=ECS.api.emUrl+"/meetingRecord";var orgUrl=ECS.api.bcUrl+"/org/porgName?orgLvl=1";$(function(){var a={init:function(){mini.parse();a.bindUI();a.logic.initOrg();a.logic.search()},table:{},bindUI:function(){$("input").blur(function(){$(this).val($.trim($(this).val()))});$("#btnQuery").click(function(){a.logic.search()})},data:{param:{}},logic:{initOrg:function(){ECS.sys.RefreshContextFromSYS();$.ajax({async:false,url:orgUrl,type:"GET",success:function(c){mini.get("orgCode").loadList(c,"orgCode","porgCode");if(ECS.sys.Context.SYS_IS_HQ){mini.get("orgCode").setValue(c[0].orgCode)}else{enterpriseCode=ECS.sys.Context.SYS_ENTERPRISE_CODE;mini.get("orgCode").disable();for(var b=0;b<c.length;b++){(function(d){if(d.orgCode==ECS.sys.Context.SYS_ENTERPRISE_CODE){mini.get("orgCode").setValue(d.orgCode)}})(c[b])}}},error:function(b){console.log(b)}})},search:function(){var c=new mini.Form("searchForm");var d=c.getData();if(d.startTime>d.endTime){layer.msg("开始时间不能大于结束时间");return}var b=mini.get("datagrid");b.set({url:meetingRecordUrl,ajaxType:"get",dataField:"pageList"});d.startTime=mini.formatDate(d.startTime,"yyyy-MM-dd HH:mm:ss");d.endTime=mini.formatDate(d.endTime,"yyyy-MM-dd HH:mm:ss");b.load(d)},rendererOperate:function(d){var f=d.record.meetingRecordId;var b="<a href=\"javascript:ECS.util.renderUploader_Page('"+mini.get("orgCode").getSelectedNode().orgCode+"','"+d.row.meetingRecordId+"','"+d.row.meetingTheme+"','17','音频会议附件上传')\"><i class=\"icon-details edit mr__5\"></i></a>";var c=b+'<a href="javascript:window.page.logic.detail('+f+')"><i class="icon-edit edit"></i></a>';return c},detail:function(b){ECS.util.detail({url:"detail.html",height:500,data:{title:"会议详情",meetingRecordId:b,pageMode:PageModelEnum.Details}})}}};a.init();window.page=a});