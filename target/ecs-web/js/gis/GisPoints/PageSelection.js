var PageSelection=function(b,a){a=$.extend({selectOnLoad:true,idField:b.idField||"id",delimiter:","},a);this.grid=b;this.options=a;this.selection=[];this.init()};PageSelection.prototype={init:function(){var b=this,a=b.grid;b.ignoreSelection=false;a.on("select",function(c){if(!b.ignoreSelection){b.addSelection([c.record]);if(b.options.selectionchange){b.options.selectionchange()}}});a.on("deselect",function(c){if(!b.ignoreSelection){b.removeSelection([c.record]);if(b.options.selectionchange){b.options.selectionchange()}}});a.on("load",function(h){if(b.options.selectOnLoad){var g=[];var f=b.selection;for(var d=0,c=f.length;d<c;d++){var k=f[d];var m=String(k[b.options.idField]);var j=a.getRow(m);if(j){g.push(j)}}b.ignoreSelection=true;a.selects(g);b.ignoreSelection=false}})},getRecordIndex:function(f){var d=this.selection,b=this.options.idField;if(f instanceof Object){f=f[b]}for(var c=0,a=d.length;c<a;c++){var e=d[c];if(e[b]===f){return c}}return null},getRecord:function(a){return this.selection[this.getRecordIndex(a)]},isSelected:function(a){var b=this.getRecord(a);return !!b},addSelection:function(c){for(var d=0,b=c.length;d<b;d++){var a=c[d];if(!this.isSelected(a)){this.selection.push(a)}}},removeSelection:function(c){var g=this;var f=this.grid;g.ignoreSelection=true;c=c.clone();for(var e=0,b=c.length;e<b;e++){var a=c[e];var d=this.getRecordIndex(a);if(d!=-1){this.selection.removeAt(d)}}f.deselects(c);g.ignoreSelection=false},clearSelection:function(){this.removeSelection(this.selection)},getSelection:function(){return this.selection},getSelectionValue:function(f,d){if(!f){f=this.options.idField}if(!d){d=this.options.delimiter}var c=this.getSelection();var h=[];for(var e=0,b=c.length;e<b;e++){var a=c[e];var g=a[f];h.push(g)}return h.join(",")}};