var tempPersonUrl=ECS.api.emUrl+"/msg/addTemporaryStaff";$(function(){var a={init:function(){mini.parse();this.bindUI()},bindUI:function(){$("input").blur(function(){var b=$.trim($(this).val());$(this).val(b);mini.get(this.name).setValue(b)});$(".btnClose").click(function(){a.logic.closeLayer(false)});$("#btnSave").click(function(){a.logic.saveTempPerson()})},data:{param:{}},logic:{setData:function(b){$("#title-main").text(b.title)},saveTempPerson:function(){a.logic.formValidate();if(!$("#AddOrEditModal").valid()){return}var b=ECS.form.getData("AddOrEditModal");if(b.privatePersonMobile==""&&b.privatePersonPhone==""){layer.msg("手机和座机不能都为空！");return}ECS.util.addOrEdit({url:tempPersonUrl,data:b},function(c){c=$.parseJSON(c);if(c.isSuccess){layer.msg("添加成功",{time:1000},function(){parent.page.logic.initTempTable();a.logic.closeLayer(true)})}else{layer.msg(c.message,{time:1000})}})},closeLayer:function(){var b=parent.layer.getFrameIndex(window.name);parent.layer.close(b)},formValidate:function(){ECS.form.formValidate("AddOrEditModal",{rules:{privatePersonName:{required:true},privatePersonPhone:{simplePhone:true},privatePersonMobile:{mobile:true}}})}}};a.init();window.page=a});