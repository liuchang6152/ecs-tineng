var teamUrl=ECS.api.apUrl+"/policeProcess/getUserTeamId";var searchUrl=ECS.api.apUrl+"/policeProcess/getTeamByTeamIdStatus";var updateUrl=ECS.api.apUrl+"/firemanGo/changeVehicleState";http:window.pageLoadMode=PageLoadMode.None;var enterpriseCode="";$(function(){var a={init:function(){mini.parse();this.bindUI();a.logic.initTable();a.logic.InitTeam()},table:{},bindUI:function(){$("input").blur(function(){$(this).val($.trim($(this).val()))});$("#btnQuery").click(function(){a.logic.search()});mini.get("datagrid").on("cellendedit",function(b){a.logic.onchange(b)})},data:{param:{}},logic:{InitTeam:function(){$.ajax({url:teamUrl,type:"get",contentType:"application/json;charset=utf-8",success:function(b){if(b.result){$("#lbteam").text(b.result.teamName);a.logic.search(b.result.teamId)}},error:function(b){}})},show_Detail:function(b){return'<a href="javascript:window.page.logic.detail('+b.row.vehicleId+')">详情</a>'},detail:function(b){var c="../../html/edd/MsgSchedul/VehicleAlarmStatus.html?r="+Math.random();window.parent.layerOpen(c,b,function(){},{height:"550px",width:"80%",closeBtn:1})},initTable:function(){mini.parse();grid=mini.get("datagrid")},show_edit:function(b){return ECS.util.editRender(b.row.commGroupTypeId,b.row.enterpriseCode)},search:function(b){grid.set({url:searchUrl+"?teamIds="+b,ajaxType:"get",dataField:"pageList"});grid.load()},onchange:function(c){var b={vehicleID:c.row.vehicleId,poactionStatus:c.value};$.ajax({url:updateUrl,async:false,type:"PUT",data:JSON.stringify(b),dataType:"json",contentType:"application/json;charset=utf-8",success:function(d){if(d.isSuccess){a.logic.VehicleArr()}layer.msg(d.message)},error:function(d){layer.msg(d.responseText)}})},closeLayer:function(b){window.parent.pageLoadMode=window.pageLoadMode;parent.layer.close(index)},}};a.init();window.page=a});