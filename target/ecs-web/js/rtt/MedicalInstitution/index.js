var madicalUrl=ECS.api.rttUrl+"/medicalInstitutio";var madicalTypeUrl=ECS.api.rttUrl+"/medicalInstitutio/getAllMediInstitutionType";var inUseUrl=ECS.api.commonUrl+"/getInUse";$(function(){var a={init:function(){mini.parse();a.logic.initPage();a.logic.search();this.bindUI()},table:{},bindUI:function(){$("input").blur(function(){var b=$.trim($(this).val());$(this).val(b);mini.get(this.name).setValue(b)});$("#btnAdd").click(function(){a.logic.add()});$("#btnDel").click(function(){a.logic.del()});$("#btnQuery").click(function(){a.logic.search()})},data:{param:{}},logic:{initPage:function(){ECS.util.bindCmb({ctrId:"typeID",url:madicalTypeUrl,idField:"typeID",textField:"typeName"});ECS.util.bindCmb({ctrId:"inUse",url:inUseUrl,data:{isAll:true},idField:"key",textField:"value"},function(){mini.get("inUse").select(0)})},search:function(){var b=mini.get("datagrid");b.set({url:madicalUrl,ajaxType:"get",dataField:"pageList"});var c=new mini.Form("searchForm");var d=c.getData();b.load(d)},add:function(){ECS.util.detail({url:"addOrEdit.html",height:500,data:{title:"新增医疗机构",pageMode:PageModelEnum.NewAdd}})},edit:function(b){var c=mini.get("datagrid").getRowByUid(b);ECS.util.detail({url:"addOrEdit.html",height:500,data:{title:"编辑医疗机构",pageMode:PageModelEnum.Edit,id:c.institutionId}})},del:function(){ECS.util.del({url:madicalUrl,grid:mini.get("datagrid"),idField:"institutionId",delArrKey:"institutionIds"},function(b){b=$.parseJSON(b);if(b.isSuccess){layer.msg("操作成功",{time:1000},function(){a.logic.search();a.logic.closeLayer(true)})}else{layer.msg(b.message)}})},rendererInUse:function(b){return ECS.util.renderer(b,[{key:0,value:"否"},{key:1,value:"是"}])}}};a.init();window.page=a});