var teamUrl=ECS.api.rttUrl+"/team/getAllSquadron";var bindTeamUrl=ECS.api.rttUrl+"/team/updateSquadron";$(function(){var a={init:function(){mini.parse();this.bindUI();this.logic.initPage()},bindUI:function(){$("#btnSave").click(function(){a.logic.save()});$(".btnClose").click(function(){a.logic.closeLayer(false)})},data:{param:{}},logic:{initPage:function(){},loadTeam:function(b){$.ajax({url:teamUrl+"?drtDeptId="+a.data.param.orgId+"&dutyGrade="+b,type:"GET",success:function(c){mini.get("team").setData(c);mini.get("team").setValue(a.data.param.bindTeamIds)},error:function(c){console.log(c)}})},setData:function(b){$("#title-main").text(b.title);a.data.param.orgId=b.orgId;a.data.param.dutyGrade=b.dutyGrade;a.data.param.bindTeamIds=b.bindTeamIds;a.logic.loadTeam(b.dutyGrade)},save:function(){var b={drtDeptId:a.data.param.orgId,teamIds:mini.get("team").getValue().split(",")};if(a.data.param.dutyGrade==0){b.dutyGrade=0}else{if(a.data.param.dutyGrade==1){b.dutyGrade=1}}$.ajax({url:bindTeamUrl,type:"POST",data:JSON.stringify(b),contentType:"application/json;charset=utf-8",success:function(c){if(c.isSuccess){if(a.data.param.dutyGrade==0){parent.page.logic.loadDuty(a.data.param.orgId)}else{if(a.data.param.dutyGrade==1){parent.page.logic.loadJoin(a.data.param.orgId)}}a.logic.closeLayer()}else{layer.msg(c.message)}},error:function(c){console.log(c)}})},closeLayer:function(){var b=parent.layer.getFrameIndex(window.name);parent.layer.close(b)}}};a.init();window.page=a});