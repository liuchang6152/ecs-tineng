var historyUrl=ECS.api.rttUrl+"/vehicle/getVehicleMalfunction";var systemNameUrl=ECS.api.rttUrl+"/vehicle/getSystemName";var leLevelUrl=ECS.api.rttUrl+"/vehicle/getVehicleLevel";$(function(){var a={init:function(){mini.parse();a.logic.initPage();this.bindUI()},bindUI:function(){$("input").blur(function(){$(this).val($.trim($(this).val()))});$("#btnQuery").click(function(){a.logic.search()});$("#btnReset").click(function(){a.logic.reset()});$(".btnClose").click(function(){a.logic.closeLayer(false)})},data:{param:{}},logic:{initPage:function(){ECS.util.bindCmb({ctrId:"systemId",url:systemNameUrl,idField:"id",textField:"name"});ECS.util.bindCmb({ctrId:"priority",url:leLevelUrl,idField:"key",textField:"value"})},setData:function(b){$("#title-main").text(b.title);mini.get("vehicleId").setValue(b.id);mini.get("vehicleName").setValue(b.vehicleName);a.logic.search()},search:function(){var b=mini.get("datagrid");b.set({url:historyUrl,ajaxType:"GET"});var c=new mini.Form("searchForm");var d=c.getData();d.startTime=mini.formatDate(d.startTime,"yyyy-MM-dd");d.endTime=mini.formatDate(d.endTime,"yyyy-MM-dd");b.load(d)},reset:function(){mini.get("systemId").setValue("");mini.get("priority").setValue("");mini.get("relevantModuleCh").setValue("");mini.get("startTime").setValue("");mini.get("endTime").setValue("")},render_picPath:function(){return'<a title="图片">图片</a>'},closeLayer:function(c){var b=parent.layer.getFrameIndex(window.name);parent.layer.close(b)}}};a.init();window.page=a});