var loadListUrl=ECS.api.rttUrl+"/msdsFrimAtb";var getOrgIdUrl=ECS.api.bcUrl+"/org/getOrgIdByCode";var grid=null;var orgId="";window.pageLoadMode=PageLoadMode.None;$(function(){var a={init:function(){mini.parse();ECS.sys.RefreshContextFromSYS();a.logic.GetOrgId(function(){a.logic.initTable()});this.bindUI()},table:{},bindUI:function(){$("#btnEdit").on("click",function(){a.logic.edit()})},data:{param:{}},logic:{initTable:function(){grid=mini.get("datagrid");grid.set({url:loadListUrl,ajaxType:"get",dataField:"pageList"});a.logic.search(true)},search:function(b){a.data.param={};if(b){a.data.param.sortType=1}a.data.param.orgId=orgId;grid.load(a.data.param)},edit:function(){var b=PageModelEnum.Edit,c="维护属性";a.logic.detail(c,"",b)},detail:function(d,b,c){layer.open({type:2,closeBtn:0,area:["850px","450px"],skin:"new-class",shadeClose:false,title:false,content:"MaintainMSDSFrimAtb.html?"+Math.random(),success:function(f,g){var e=layer.getChildFrame("body",g);var i=window[f.find("iframe")[0]["name"]];var h={pageMode:c,msdsId:b,title:d};i.page.logic.setData(h)},end:function(){a.logic.search(-1);window.pageLoadMode=PageLoadMode.None}})},GetOrgId:function(b){$.ajax({url:getOrgIdUrl+"?orgCode="+ECS.sys.Context.SYS_ENTERPRISE_CODE,type:"GET",timeout:5000,success:function(c){orgId=c.orgId;b&&b()}})},}};a.init();window.page=a});