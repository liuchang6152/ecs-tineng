var getSingleUrl=ECS.api.rttUrl+"/msds/findOne";var FileDownLoadUrl=ECS.api.rttUrl+"/structuredplanfile/downloadFile";var msdsId;var structuredPlanCategoryId;$(function(){var a=parent.layer.getFrameIndex(window.name);var b={init:function(){mini.parse();this.bindUI()},bindUI:function(){$("#btnSave").click(function(){b.logic.closeLayer(PageLoadMode.Refresh)});$("#btnClose,#btnClose2").click(function(){b.logic.closeLayer(PageLoadMode.None)})},logic:{setData:function(c){$("#title-main").text(c.title);msdsId=c.msdsId;$("#MsDsPlanName").html(c.pagename);$("#main-content").css("height",($("body").outerHeight()-$("#head_title").height()-10)+"px");if(c.ishidden=="true"){$("#btnSave").show();$("#btnClose").show();$("#btnClose2").hide()}else{$("#btnSave").hide();$("#btnClose").hide();$("#btnClose2").show()}$.ajax({url:getSingleUrl+"?msdsId="+c.msdsId+"&now="+Math.random(),type:"get",async:true,dataType:"json",success:function(g){$("#orgSname").html(g.orgSname);$("#msdsChineseName").html(g.msdsChineseName);$("#msdsEnglishName").html(g.msdsEnglishName);$("#msdsAliasName").html(g.msdsAliasName);$("#casno").html(g.casno);$("#materialCode").html(g.materialCode);var e="";for(var d=0;d<g.riskTypeEntityList.length;d++){(function(i){if(d==g.riskTypeEntityList.length-1){e+=i.riskTypeName}else{e+=i.riskTypeName+","}})(g.riskTypeEntityList[d])}$("#riskTypeName").html(e);b.logic.render_childAttr_list(g.msdsTotalTypeValueForEdit);if(g.attachmentEntities){var f=[];for(var h=0;h<g.attachmentEntities.length;h++){$("#fileList").append('<a style="display: inline-block;width: 50%;float:left;margin-top:10px;" title="'+g.attachmentEntities[h].atchName+'" href="'+FileDownLoadUrl+"?atchPath="+g.attachmentEntities[h].atchPath+"&atchName="+g.attachmentEntities[h].atchName+'">'+g.attachmentEntities[h].atchName+"</a>")}}},error:function(d){var e=$.parseJSON(d.responseText);layer.msg(e.collection.error.message)}})},render_childAttr_list:function(e,c){$("#dymic_data").html("");for(var d=0;d<e.length;d++){if(e[d]["subparams"].length==0){continue}(function(m){var l=$('<div class="one_attr" style="margin-left:15px;"></div>');$("#dymic_data").append(l);var g=$('<div class="split-line"></div>');$(l).append(g);var i=$('<div class="one_title" style="font-size:14px;color:#505050;font-weight: bold;">'+m.mainParam+"：</div>");$(l).append(i);var j=m.subparams;var k=null;for(var f=0;f<j.length;f++){k=$('<div class="mt__15"></div>');l.append(k);var h=$('<div class="control-label" style="color:#a5aaae;">'+(j[f]["k"]?j[f]["k"]:"无")+'</div><div id="materialCode" style="color:#505050;">'+(j[f]["v"]?j[f]["v"]:"无")+"</div>");k.append(h)}})(e[d])}c&&c()},closeLayer:function(c){window.parent.pageLoadMode=c;parent.layer.close(a)}}};b.init();window.page=b});